const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/roger-tiles.D74qxO8g.js","_astro/spa-router.3jzHxz5n.js","_astro/team-init.guyrCxLL.js","_astro/role-back.DxKcLhxM.js","_astro/hero-block.CQHbB6ve.js","_astro/UnrealBloomPass.D6T5-zMz.js","_astro/route-transitions.BWgHaGMb.js"])))=>i.map(i=>d[i]);
import{_ as l}from"./spa-router.3jzHxz5n.js";const U="__dev_build__",V="__prim3_intro_seen",$="__prim3_force_intro",te="/team/index.html";let F=!1,w=null;const S=["binding","etching","charging","calibrating","linking","seal"],K={binding:"BINDING SIGILS",etching:"ETCHING FIELD GRID",charging:"CHARGING HERO CORE",calibrating:"CALIBRATING ODOM / IMU",linking:"LINKING CHANNELS",seal:"SEAL INTEGRITY"},N=["OATH ACCEPTED. ENTER THE HERO STAGE.","THE GRID AWAKENS. YOUR PARTY IS BOUND.","CHANNEL LOCK: OP3 // BEGIN RUN."],ne=["> mount: summoning shell // ok","> bootstrap: ritual console // online"];function oe(){if(typeof window>"u")return!0;try{if(new URLSearchParams(window.location.search).get("intro")==="1")return!0}catch{}try{if(window.localStorage.getItem($)==="1")return!0}catch{}try{return window.localStorage.getItem(V)!==U}catch{return!0}}function ae(){try{window.localStorage.setItem(V,U),window.localStorage.removeItem($)}catch{}}function q(){typeof window>"u"||(window.__PRIM3_LOADER_READY=!0,window.dispatchEvent(new CustomEvent("site-loader:start")))}function B(){document.getElementById("preload-manifest")?.remove()}function ie(){F=!0}function H(){return typeof window>"u"||typeof fetch>"u"||F?Promise.resolve():w||(w=fetch(te,{credentials:"same-origin",cache:"force-cache"}).then(()=>{ie()}).catch(r=>{throw w=null,r}),w)}function se(r){return new Promise(o=>{if(!r){o();return}const d=()=>o(),i=new Image;i.decoding="async",i.loading="eager",i.onload=d,i.onerror=()=>{typeof fetch=="function"?fetch(r,{mode:"no-cors"}).catch(()=>{}).finally(d):d()},i.src=r,i.complete&&d()})}function ce(r={}){if(typeof window>"u"||typeof document>"u")return;const o=document.querySelector("[data-site-loader]");if(!o){B(),q(),document.body&&(document.body.dataset.loaderState="done");return}const d=o.querySelector("[data-loader-bar]"),i=o.querySelector("[data-loader-status]"),D=o.querySelector("[role='progressbar']"),m=o.querySelector("[data-press-start]"),W=Array.from(o.querySelectorAll("[data-phase-key]")),y=o.querySelector(".site-loader__panel"),f=o.querySelector(".site-loader__header-seal"),g=o.querySelector("[data-loader-prophecy]"),h=o.querySelector("[data-loader-log]"),R=o.querySelector("[data-loader-relic-charge]");let P=0,G=0,T=0;const v=new Map;W.forEach(e=>{const t=e.dataset.phaseKey;t&&v.set(t,e)});const c={binding:{total:0,done:0,state:"PENDING"},etching:{total:0,done:0,state:"PENDING"},charging:{total:0,done:0,state:"PENDING"},calibrating:{total:0,done:0,state:"PENDING"},linking:{total:0,done:0,state:"PENDING"},seal:{total:0,done:0,state:"PENDING"}},I=e=>{document.body&&(document.body.dataset.loaderState=e)},E=e=>{if(!h)return;const t=document.createElement("p");for(t.className="site-loader__log-line",t.textContent=e,h.appendChild(t);h.children.length>10;)h.firstElementChild?.remove();h.scrollTop=h.scrollHeight},j=()=>{y&&(y.classList.add("is-phase-flip"),window.clearTimeout(G),G=window.setTimeout(()=>y.classList.remove("is-phase-flip"),110))},p=(e,t)=>{const n=c[e];if(!n||n.state===t)return;n.state=t;const a=v.get(e);if(a){a.dataset.phaseStatus=t,a.classList.toggle("is-syncing",t==="SYNCING"),a.classList.toggle("is-locked",t==="LOCKED"),a.classList.toggle("is-pending",t==="PENDING");const u=a.querySelector("[data-phase-state]");u&&(u.textContent=t)}t==="LOCKED"&&(j(),f&&(f.textContent=`SEAL: ${K[e]} LOCKED`)),t==="SYNCING"&&i&&(i.textContent=`${K[e]} // SYNCING`)},A=e=>{if(p(e,"LOCKED"),e!=="seal"){const t=S.find(n=>{if(n==="seal")return!1;const a=c[n];return a.total>0&&a.done<a.total&&a.state!=="LOCKED"});t&&p(t,"SYNCING")}},O=e=>{const t=Math.max(0,Math.min(1,e));o.style.setProperty("--loader-progress",t.toFixed(3)),R&&(R.style.width=`${Math.round(t*100)}%`)},_=e=>{const t=Math.max(0,Math.min(1,e||0)),n=Math.round(t*100);o.dataset.active="true",O(t),d&&(d.style.width=`${n}%`),D&&D.setAttribute("aria-valuenow",`${n}`)},z=()=>{window.clearInterval(P),window.clearTimeout(T),P=0,T=0},J=()=>{z(),i&&(i.textContent="CHANNEL LINKED"),f&&(f.textContent="SEAL: INTEGRITY STABLE"),I("done"),window.setTimeout(()=>{o.dataset.active="false",B()},300)},L=()=>{ae(),q(),J()},Q=()=>{if(I("armed"),i&&(i.textContent="SUMMONING GRID READY"),f&&(f.textContent="SEAL: READY"),g){let n=0;g.textContent=N[n],P=window.setInterval(()=>{n=(n+1)%N.length,g.textContent=N[n]??N[0]},2400)}E("> seal: memory lattice // stable"),o.classList.add("is-stable"),m&&(m.classList.add("is-visible","is-ignite"),window.setTimeout(()=>m.classList.remove("is-ignite"),680));const e=()=>{m?(m.classList.add("is-casting"),T=window.setTimeout(()=>{m.classList.remove("is-visible","is-casting"),L()},190)):L()};m?.addEventListener("click",e,{once:!0});const t=n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),window.removeEventListener("keydown",t),e())};window.addEventListener("keydown",t)},C=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion: reduce)").matches;if(ne.forEach(E),g&&(g.textContent="THE RITUAL LATTICE IS FORMING..."),!oe()){I("loading"),o.dataset.active="true",p("binding","SYNCING"),_(.45);const e=[],t=document.fonts?.ready;t&&e.push(t.then(()=>{}).catch(()=>{})),e.push(H().catch(()=>{})),Promise.all(e).then(()=>new Promise(n=>setTimeout(n,C?90:280))).catch(()=>new Promise(n=>setTimeout(n,C?90:280))).then(()=>{S.forEach(n=>p(n,"LOCKED")),_(1),L()});return}I("loading"),_(0);const X=Array.from(new Set((r.assets??[]).filter(Boolean))),b=[];let k=0,M=0;const s=(e,t,n)=>{M+=1,c[e].total+=1,c[e].state==="PENDING"&&(S.some(u=>c[u].state==="SYNCING")||p(e,"SYNCING")),b.push(n.then(()=>{E(`${t} // ok`)}).catch(()=>{E(`${t} // fallback`)}).then(()=>{k+=1,c[e].done+=1,_(k/Math.max(1,M)),c[e].done>=c[e].total&&A(e)}))},Z=performance.now(),Y=document.fonts?.ready;Y&&s("binding","> bind: type sigils",Y),s("etching","> preload: team route shell",H()),s("etching","> bind: roger tiles module",l(()=>import("./roger-tiles.D74qxO8g.js"),__vite__mapDeps([0,1]))),s("etching","> bind: team scene bootstrap",l(()=>import("./team-init.guyrCxLL.js"),__vite__mapDeps([2,1,0,3])));for(const e of X)s("charging",`> preload: ${e.split("/").pop()??"asset"}`,se(e));s("charging","> preload: hero core module",l(()=>import("./hero-block.CQHbB6ve.js"),__vite__mapDeps([4,1,5]))),s("calibrating","> compile: world shader cache",l(()=>import("./spa-router.3jzHxz5n.js").then(e=>e.j),[]).then(e=>{try{const t=new e.WebGLRenderer({alpha:!0,antialias:!1,powerPreference:"low-power"});t.setSize(1,1);const n=new e.BoxGeometry(1,1,1),a=new e.MeshBasicMaterial,u=new e.Mesh(n,a),x=new e.Scene;x.add(u);const ee=new e.PerspectiveCamera;t.render(x,ee),n.dispose(),a.dispose(),t.dispose()}catch{}})),s("linking","> bind: role arcana modules",l(()=>import("./role-back.DxKcLhxM.js"),[])),s("linking","> link: route transition matrix",l(()=>import("./route-transitions.BWgHaGMb.js"),__vite__mapDeps([6,1]))),s("linking","> link: gsap channel",l(()=>import("./index.Dj4XqqbB.js"),[])),s("linking","> link: scroll trigger channel",l(()=>import("./ScrollTrigger.CcPJIpJ9.js"),[])),s("linking","> link: lenis channel",l(()=>import("./lenis.DpvFmOB5.js"),[])),Promise.all(b).then(()=>{const e=performance.now()-Z,t=Math.max(0,r.minDuration??0),n=Math.max(0,t-e);window.setTimeout(()=>{S.forEach(a=>{if(a==="seal")return;c[a].state!=="LOCKED"&&A(a)}),p("seal","SYNCING"),E("> seal: integrity lattice // syncing"),window.setTimeout(()=>{A("seal"),o.classList.add("is-stable"),O(1),_(1),C?L():Q()},140)},n)})}export{ce as b,H as p};
